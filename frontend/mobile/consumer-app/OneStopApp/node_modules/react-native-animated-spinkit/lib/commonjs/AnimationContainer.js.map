{"version":3,"sources":["AnimationContainer.tsx"],"names":["AnimationContainer","React","Component","constructor","props","animation","start","stop","key","animatedValuesByKey","setValue","initAnimation","animationInitializersByKey","animations","animationInitializer","animationValue","Animated","Value","values","push","interpolationsByKey","length","parallel","componentDidMount","startAnimation","componentDidUpdate","prevProps","animating","stopAnimation","componentWillUnmount","render","children"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;AAee,MAAMA,kBAAN,SAELC,KAAK,CAACC,SAFD,CAEqB;AAelCC,EAAAA,WAAW,CAACC,KAAD,EAAkB;AAC3B,UAAMA,KAAN;;AAD2B;;AAAA,iDAboB,EAapB;;AAAA,iDANzB,EAMyB;;AAAA,4CAuCZ,MAAM;AACrB,WAAKC,SAAL,CAAeC,KAAf;AACD,KAzC4B;;AAAA,2CA2Cb,MAAM;AACpB,WAAKD,SAAL,CAAeE,IAAf;;AAEA,WAAK,MAAMC,GAAX,IAAkB,KAAKC,mBAAvB,EAA4C;AAC1C,aAAKA,mBAAL,CAAyBD,GAAzB,EAA8BE,QAA9B,CAAuC,CAAvC;AACD;AACF,KAjD4B;;AAE3B,UAAM;AAAEC,MAAAA;AAAF,QAAoBP,KAA1B;AAEA,UAAMQ,0BAA0B,GAAGD,aAAa,EAAhD;AACA,UAAME,UAAyC,GAAG,EAAlD;;AAEA,SAAK,MAAML,GAAX,IAAkBI,0BAAlB,EAA8C;AAC5C,YAAME,oBAAoB,GAAGF,0BAA0B,CAACJ,GAAD,CAAvD;AACA,YAAMO,cAAc,GAAG,IAAIC,sBAASC,KAAb,CAAmB,CAAnB,CAAvB;AACA,WAAKR,mBAAL,CAAyBD,GAAzB,IAAgCO,cAAhC;AACA,YAAM;AAAEV,QAAAA,SAAF;AAAaa,QAAAA;AAAb,UAAwBJ,oBAAoB,CAACC,cAAD,CAAlD;AACAF,MAAAA,UAAU,CAACM,IAAX,CAAgBd,SAAhB;AACA,WAAKe,mBAAL,CAAyBZ,GAAzB,IAAgCU,MAAhC;AACD;;AAED,QAAIL,UAAU,CAACQ,MAAX,KAAsB,CAA1B,EAA6B;AAC3B,WAAKhB,SAAL,GAAiBQ,UAAU,CAAC,CAAD,CAA3B;AACD,KAFD,MAEO;AACL,WAAKR,SAAL,GAAiBW,sBAASM,QAAT,CAAkBT,UAAlB,CAAjB;AACD;AACF;;AAEDU,EAAAA,iBAAiB,GAAG;AAClB,SAAKC,cAAL;AACD;;AAEDC,EAAAA,kBAAkB,CAACC,SAAD,EAAsB;AACtC,UAAM;AAAEC,MAAAA;AAAF,QAAgB,KAAKvB,KAA3B;;AAEA,QAAIuB,SAAS,KAAKD,SAAS,CAACC,SAA5B,EAAuC;AACrC,UAAIA,SAAJ,EAAe;AACb,aAAKH,cAAL;AACD,OAFD,MAEO;AACL,aAAKI,aAAL;AACD;AACF;AACF;;AAcDC,EAAAA,oBAAoB,GAAG;AACrB,SAAKxB,SAAL,CAAeE,IAAf;AACD;;AAEDuB,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEC,MAAAA;AAAF,QAAe,KAAK3B,KAA1B;AACA,WAAO2B,QAAQ,GAAGA,QAAQ,CAAC,KAAKX,mBAAN,CAAX,GAAwC,IAAvD;AACD;;AAzEiC;;;;gBAFfpB,kB,kBAaG;AACpB2B,EAAAA,SAAS,EAAE;AADS,C","sourcesContent":["import * as React from 'react'\nimport { Animated } from 'react-native'\n\ninterface AnimationNode {\n  animation: Animated.CompositeAnimation\n  values: Animated.AnimatedInterpolation[]\n}\n\nexport interface Props<T extends string> {\n  initAnimation: () => Record<T, (value: Animated.Value) => AnimationNode>\n  children: (\n    interpolationsByKey: Record<T, Animated.AnimatedInterpolation[]>\n  ) => React.ReactNode\n  animating: boolean\n}\n\nexport default class AnimationContainer<\n  T extends string\n> extends React.Component<Props<T>> {\n  animation: Animated.CompositeAnimation\n  animatedValuesByKey: Record<T, Animated.Value> = {} as Record<\n    T,\n    Animated.Value\n  >\n  interpolationsByKey: Record<\n    T,\n    Animated.AnimatedInterpolation[]\n  > = {} as Record<T, Animated.AnimatedInterpolation[]>\n\n  static defaultProps = {\n    animating: true,\n  }\n\n  constructor(props: Props<T>) {\n    super(props)\n    const { initAnimation } = props\n\n    const animationInitializersByKey = initAnimation()\n    const animations: Animated.CompositeAnimation[] = []\n\n    for (const key in animationInitializersByKey) {\n      const animationInitializer = animationInitializersByKey[key]\n      const animationValue = new Animated.Value(0)\n      this.animatedValuesByKey[key] = animationValue\n      const { animation, values } = animationInitializer(animationValue)\n      animations.push(animation)\n      this.interpolationsByKey[key] = values\n    }\n\n    if (animations.length === 1) {\n      this.animation = animations[0]\n    } else {\n      this.animation = Animated.parallel(animations)\n    }\n  }\n\n  componentDidMount() {\n    this.startAnimation()\n  }\n\n  componentDidUpdate(prevProps: Props<T>) {\n    const { animating } = this.props\n\n    if (animating !== prevProps.animating) {\n      if (animating) {\n        this.startAnimation()\n      } else {\n        this.stopAnimation()\n      }\n    }\n  }\n\n  startAnimation = () => {\n    this.animation.start()\n  }\n\n  stopAnimation = () => {\n    this.animation.stop()\n\n    for (const key in this.animatedValuesByKey) {\n      this.animatedValuesByKey[key].setValue(0)\n    }\n  }\n\n  componentWillUnmount() {\n    this.animation.stop()\n  }\n\n  render() {\n    const { children } = this.props\n    return children ? children(this.interpolationsByKey) : null\n  }\n}\n"]}